(function(b){var a;a=(function(){function c(e,d){var f=this;this.isSubmiting=false;this.form=e;this.jform=b(e);this.opt=d;this.formErrorContainer=this.opt.formErrorContainer||"#formValidPrompt";this.opt.disableFormClass=this.opt.disableFormClass||"disable-form";if(d.submitBtn){b(d.submitBtn).click(function(g){f.submitEvent={btn:b(this),event:g};f.submit()})}if(d.resetBtn){b(d.resetBtn).click(function(){f.resetForm()})}if(d.validator){this.validator=this.jform.validate(d.validator)}this.disableForm=function(){f.isSubmiting=true;b(d.submitBtn).each(function(){var g=b(this).find(".fa").attr("class");if(g){b(this).attr("icon-class",g);b(this).find(".fa").removeAttr("class").addClass("fa fa-spinner")}b(this).addClass(f.opt.disableFormClass)})};this.enableForm=function(){f.isSubmiting=false;b(d.submitBtn).each(function(){b(this).removeClass(f.opt.disableFormClass);var g=b(this).attr("icon-class");b(this).find(".fa").attr("class",g)})};this.jform.ajaxForm({url:this.jform.attr("action"),type:this.jform.attr("method")})}c.prototype.validate=function(){var d;if(!this.opt.validator){d=true}else{if(!this.opt.beforeValidate||this.opt.beforeValidate()!==false){d=this.jform.valid()}else{d=false}}if(!d){b(this.formErrorContainer).show();if(b(this.formErrorContainer).html()==""){b(this.formErrorContainer).html("&nbsp;请检查表单数据,请提交正确的数据!")}}else{b(this.formErrorContainer).hide()}return d};c.prototype.resetForm=function(d){this.jform.validate().resetForm();this.form.reset();this.jform.find(".form-control.error").removeClass("error");this.opt.resetForm&&this.opt.resetForm();d&&d(this.jform)};c.prototype.getValidator=function(){return this.validator};c.prototype.valitate=function(d){return this.validator.validate().element(d)};c.prototype.getUrl=function(d){if(d){return d}else{if(b.isFunction(this.opt.url)){return this.opt.url.apply(this)}else{if(b.type(this.opt.url)=="string"){return this.opt.url}else{if(this.submitEvent.btn.attr("action")){return this.submitEvent.btn.attr("action")}else{return this.jform.attr("action")}}}}};c.prototype.doSuccess=function(i,d,h,g){var f=b(g).data("easyForm");var e=f.submitEvent;try{BootstrapDialog.alert({title:"系统操作提示!",message:i.msg,closable:true,type:(i.status=="0"?BootstrapDialog.TYPE_SUCCESS:BootstrapDialog.TYPE_DANGER),size:BootstrapDialog.SIZE_SMALL,buttonLabel:"确 认",callback:function(){if(i.status=="0"){if(f.opt.success){if(b.isFunction(f.opt.success)){f.opt.success(i,e)}else{var j=f.opt.success;if(j.lastIndexOf("?")!=-1){j=j+"&"}else{j=j+"?"}location.href=(j+"keepSP=Y")}}}else{f.opt.error&&f.opt.error(i,e)}}})}finally{f.enableForm()}};c.prototype.doComplete=function(g,d,f){accessDefine(g);var e=b(f).data("easyForm");e.enableForm()};c.prototype.submit=function(d){if(!this.isSubmiting){this.disableForm();var g=this;try{if(this.validate()){this.jform.ajaxSubmit({url:this.getUrl(d),success:this.doSuccess,complete:this.doComplete,data:function(){return g.opt.extraData?g.opt.extraData.apply(g,this):{}},beforeSerialize:function(){return g.opt.beforeSerialize&&g.opt.beforeSerialize.apply(g,this)},beforeSubmit:function(){return g.opt.beforeSubmit&&g.opt.beforeSubmit.apply(g,this)}})}else{this.enableForm()}}catch(f){throw f;this.enableForm()}}};return c})();b.fn.easyForm=function(d){var e,c=Array.prototype.slice.call(arguments,1);return this.each(function(){var h=b(this),g=h.data("easyForm"),f=b.extend({},h.data(),typeof d==="object"&&d);if(typeof d==="string"){if(!g){return}e=g[d].apply(g,c);if(d==="destroy"){h.removeData("easyForm")}}if(!g){g=new a(this,f);h.data("easyForm",g)}});return typeof e==="undefined"?this:e}})(jQuery);